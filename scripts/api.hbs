/**
 * This file is auto-generated by the openapi zod client script.
 * DO NOT EDIT THIS FILE MANUALLY.
 */

import { apiUrl } from "@/core/config";
import { makeApi, Zodios } from "@zodios/core";
import { z } from "zod";

{{#if types}}
// Types
{{#each types}}
export {{{this}}}
{{/each}}
{{/if}}

// Schemas
{{#each schemas}}
const {{@key}}{{#if (lookup ../types @key)}}: z.ZodType<{{@key}}>{{/if}} = {{{this}}};
{{#if (notEmitted @key ../types)}}
export type {{@key}} = z.infer<typeof {{@key}}>;
{{/if}}

{{/each}}

{{#ifNotEmptyObj schemas}}
export const schemas = {
{{#each schemas}}
	{{@key}},
{{/each}}
};
{{/ifNotEmptyObj}}

// Apis
{{#each endpointsGroups}}
const {{camelCase @key}}Endpoints = makeApi([
{{#each this.endpoints}}
	{
		method: "{{method}}",
		path: "{{path}}",
		{{#if @root.options.withAlias}}
		{{#if alias}}
		alias: "{{camelCase alias}}",
		{{/if}}
		{{/if}}
		{{#if description}}
		description: `{{description}}`,
		{{/if}}
		{{#if requestFormat}}
		requestFormat: "{{requestFormat}}",
		{{/if}}
		{{#if parameters}}
		parameters: [
			{{#each parameters}}
			{
				name: "{{name}}",
				{{#if description}}
				description: `{{description}}`,
				{{/if}}
				{{#if type}}
				type: "{{type}}",
				{{/if}}
				schema: {{{schema}}},
			},
			{{/each}}
		],
		{{/if}}
		response: {{{response}}},
		{{#if errors.length}}
		errors: [
			{{#each errors}}
			{
				{{#ifeq status "default" }}
				status: "default",
				{{else}}
				status: {{status}},
				{{/ifeq}}
				{{#if description}}
				description: `{{description}}`,
				{{/if}}
				schema: {{{schema}}},
			},
			{{/each}}
		]
		{{/if}}
	},
{{/each}}
]);
export const {{camelCase @key}}Api = new Zodios(apiUrl, {{camelCase @key}}Endpoints);
{{camelCase @key}}Api.axios.interceptors.request.use((config) => {
  // Get the cookie `jwt` from the browser
  const jwt = config.headers?.Cookie?.split("; ").find((c: string) =>
    c.startsWith("jwt="),
  );

  if (jwt) {
    // Set the `Authorization` header with the JWT token
    config.headers.Authorization = `Bearer ${jwt.split("=")[1]}`;
  }

  return config;
});

{{/each}}
